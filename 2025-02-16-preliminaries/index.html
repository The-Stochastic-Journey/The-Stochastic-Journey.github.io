<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script>let thunk=()=>{let e=e=>e.trim(),t=e=>e.innerText,n=e=>{let t=e.split(" "),n=t.slice(0,-1).join(" ");return[t.at(-1),n]},a=Array.from(document.getElementsByClassName("author")).map(t).map(e).map(n),i=a[0][0],r=(Array.from(document.getElementsByClassName("affiliation")).filter(e=>"P"===e.nodeName).map(t).map(e),"Ch:1 Preliminaries");{let e=a.map(e=>`${e[0]}, ${e[1]}`).join(" and "),t=`\n@inproceedings{${(i+"2025"+r.split(" ").slice(0,3).join("")).replace(" ","").replace(/[\p{P}$+<=>^`|~]/gu,"").toLowerCase().trim()},\n  author = {${e}},\n  title = {${r}},\n  year = {2024},\n  url  = {${window.location.href}}\n}\n  `.trim();document.getElementById("bibtex-box").innerText=t}{let e=a.map(e=>e[0]),t=`\n${e=e.length>2?e[0]+", et al.":2==e.length?e[0]+" & "+e[1]:e[0]}, "${r}", ICLR Blogposts, 2025.\n`.trim();document.getElementById("bibtex-academic-attribution").innerText=t}};document.addEventListener("readystatechange",function(){"complete"===document.readyState&&thunk()});</script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <title>Ch:1 Preliminaries - The Stochastic Journey</title> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="keywords" content="blog, Maitrey Patel, The Stochastic Journey, jekyll"> <meta name="author" content="Maitrey Patel"> <meta name="description" content=""> <link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet" type="text/css"> <link rel="stylesheet" href="https://The-Stochastic-Journey.github.io//css/main.css"> <link rel="icon" type="image/ico" href="https://The-Stochastic-Journey.github.io//assets/favicon.ico"> <link rel="shortcut-icon" type="image/ico" href="https://The-Stochastic-Journey.github.io//assets/favicon.ico"> <meta property="og:title" content="Ch:1 Preliminaries - The Stochastic Journey"> <meta property="og:image" itemprop="image" content="https://The-Stochastic-Journey.github.io//assets/favicon.ico"> <meta property="og:description" content=""> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Ch:1 Preliminaries - The Stochastic Journey"> <meta name="twitter:description" content=""> <meta name="twitter:image" content="https://The-Stochastic-Journey.github.io//assets/favicon.ico"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-83RDK6HM40"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-83RDK6HM40");</script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">{{page._styles}}</style> <d-front-matter> <script async type="text/json">{
      "title": "Ch:1 Preliminaries",
      "description": "",
      "published": "February 16, 2025",
      "authors": [
        {
          "author": "Maitreya Patel",
          "authorURL": "https://maitreyapatel.com/",
          "affiliations": [
            {
              "name": "Arizona State University",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> </head> <body class="sticky-bottom-footer"> <div class="container"> <div class="navbar"> <a class="site-title" href="https://The-Stochastic-Journey.github.io//">The Stochastic Journey</a> <ul class="pull-right"> <li class="pull-left"> <a href="https://The-Stochastic-Journey.github.io//about">About</a> / </li> <li class="pull-left"> <a href="https://maitreyapatel.com" rel="external nofollow noopener" target="_blank">Resume</a> </li> </ul> </div> </div> <div class="post distill"> <d-title> <h1>Ch:1 Preliminaries</h1> <p></p> </d-title> <d-byline></d-byline> <d-article> <p>Diffusion models are fundamentally based on stochastic differential equations (SDEs), which combine deterministic dynamics with randomness. While we understand that SDEs govern how diffusion models evolve and that ordinary differential equations (ODEs) are crucial for sampling, the mathematical foundations - particularly random variables and stochastic processes - deserve careful examination.</p> <p>This blog post aims to build a rigorous understanding of these foundational concepts. We’ll explore key definitions, theorems, and derivations from <a href="https://link.springer.com/book/10.1007/978-3-642-14394-6" rel="external nofollow noopener" target="_blank">Chapter 2 of the Book</a>, focusing on the most essential elements while providing detailed explanations where needed. By the end, we’ll try to connect it back to diffusion models.</p> <h3>Random Variable</h3> <p><strong>Definition 1.1:</strong> If \(\Omega\) is a given set, then a \(\sigma\)-algebra \(\mathcal{F}\) on \(\Omega\) is a family \(\mathcal{F}\) of subsets of \(\Omega\) with the three key properties:</p> <ol> <li>$\phi \in \mathcal{F}$</li> <li>If \(F \in \mathcal{F}\) then \(F^c \in \mathcal{F}\), where \(F^c \in \Omega \setminus \mathcal{F}\) (complement)</li> <li>If \(A_1, A_2, \ldots \in \mathcal{F}\), then \(\bigcup_{i=1}^{\infty} A_i \in \mathcal{F}\) (countable union)</li> </ol> <p>Let $P: \mathcal{F} \rightarrow [0,1]$ be the probability on a space ($\Omega, \mathcal{F}$). Then ($\Omega, \mathcal{F}, P$) together defines the probability space. Intuitively,</p> \[P(F) = \text{the probability that the event } F \text{ occurs}\] <div class="highlighted-box" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;"> <details> <summary>(Click to expand) Toy example</summary> Let's define our sample space \(\Omega\) as all possible outcomes when rolling a fair six-sided die:<br> \[ \Omega = \{1, 2, 3, 4, 5, 6\} \] A \(\sigma\)-algebra \(\mathcal{F}\) is a collection of subsets of Ω that satisfies the three properties. Hence, A simple example of a \(\sigma\)-algebra is:<br> \[ \mathcal{F}=\{\phi,\Omega,\{1,3,5\},\{2,4,6\}\} \] **Task:** Try to manually verify the above three properties. </details> </div> <p><strong>Understanding the Borel sets:</strong> We can define the smallest $\sigma$-algebra $\mathcal{H}_\mathcal{U}$ containing $\mathcal{U}$ ($\mathcal{U} \in \Omega$), then</p> \[\mathcal{H}_\mathcal{U} = \bigcap\{\mathcal{H}; \mathcal{H}~\sigma \text{-algebra of } \Omega\}.\] <p>The intersection of all $\sigma$-algebras containing $\mathcal{U}$ is itself a $\sigma$-algebra and is the smallest $\sigma$-algebra containing $\mathcal{U}$. This is called the Borel $\sigma$-algebra (i.e., $\mathcal{B} = \mathcal{H}_\mathcal{U}$) generated by $\mathcal{U}$.</p> <h3>The Stochastic Process</h3> <p><strong>Definition 1.2:</strong> A stochastic process is a parameterized collection of random variables</p> \[\{X_t\}_{t \in T}\] <p>defined on a probability space ($\Omega, \mathcal{F}, P$) and assuming values in $R^n$. Here, $T$ can be any interval [a, b] (like, in diffusion we have [0, 1000]). Utilizing this fact we can define $\omega \in \Omega$ as $\omega \rightarrow X_t(\omega)$ and $t \in T$ as $t \rightarrow X_t(\omega)$. Hence, for simplicity we can write:</p> \[(t, \omega) \rightarrow X(t, \omega)\] <p><strong>Kolmogorov’s Extension Theorem:</strong> is a fundamental result in probability theory that allows us to construct stochastic processes—random variables indexed over time—when given a consistent collection of finite-dimensional distributions.</p> <p>Intuitively, this theorem states that</p> <ol> <li>K1 (Consistency Condition) (a.k.a. Chapman-Kolmogorov equation): <ul> <li>The probability measures must be consistent under marginalization. That is, if we integrate out one of the intermediate times, the resulting probability distribution must match the lower-dimensional distribution.</li> <li>Mathematically,</li> </ul> </li> </ol> \[\int_{R^n} p(t, x, z)p(s, z, y)dz = p(t+s, x, y).\] <ol> <li>K2 (Total Probability Condition): <ul> <li>The total probability of transitioning from any initial point to any final point over all space must be 1:</li> </ul> </li> </ol> \[\int_{R^n} p(t,x,y)dy = 1, \forall t \geq 0.\] <ol> <li>Then there exists a probability space $(\Omega,\mathcal{F},P)$ and a stochastic process ${X_t}$ such that these finite distributions correspond to the probabilities of events in this space.</li> </ol> <p>This result is crucial because it guarantees that if we define random variables consistently at finite time steps, we can always extend this definition to an infinite process.</p> <div class="highlighted-box" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;"> <summary>This theorem is modified to make it easier to understand next section. However, Theorem 2.1.5 from the book provides Measure-Theoretic Form.</summary> </div> <h3>Brownian Motion</h3> <p>Brownian motion is just an example of the observed stochastic process ($B_t(\omega)$) of the pollen grains defined using the Kolmogorov’s Extension theorem. Specifically,</p> \[p(t, x, y) = (2\pi t)^{-n/2} \cdot \exp\left(-\frac{|x-y|^2}{2t}\right), \text{ where } y \in \mathbb{R}^n, t&gt;0 \text{ and fixed } x\in \mathbb{R}^n.\] <p>Then we can define probability measure as:</p> \[v_{t_1, ..., t_k} (F_1 \times ... \times F_k) = \int_{F_1} ... \int_{F_k} p(t_1, x, y_1)p(t_2-t_1, y_1, y_2)...p(t_k-t_{k-1}, y_{k-1}, y_k)dy_1...dy_k\] <p>where, $0 \leq t_1 \leq t_2 \leq … \leq t_k$. It is worth noting that, at $t=0$ we have $p(0,x,y)dy = \delta_x(y)$.</p> <p>Let’s verify that the Brownian motion equation satisfies the key criteria of Kolmogorov’s Extension Theorem:</p> <div class="highlighted-box" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;"> <details> <summary>(Click to expand) Let's verify that the Brownian motion equation satisfies the key criteria of Kolmogorov's Extension Theorem:</summary> <b>Step 1: (Chapman-Kolmogorov equation)</b> Let's verify that the transition probability density function satisfies the Chapman-Kolmogorov equation by substituting the Gaussian density function into K1: \[ \begin{aligned} \text{LHS} &amp;= \int_{\mathbb{R}^n} p(t,x,z)p(s,z,y)dz \\ &amp;= \int_{\mathbb{R}^n} (2\pi t)^{-n/2} \exp\left(-\frac{|x-z|^2}{2t}\right) (2\pi s)^{-n/2} \exp\left(-\frac{|z-y|^2}{2s}\right) dz \\ &amp;= (2\pi t)^{-n/2} (2\pi s)^{-n/2} \exp\left(-\frac{|x-y|^2}{2(t+s)}\right) \times \int_{R^n} exp \left(-\frac{1 (s+t)}{2(ts)}|z-\alpha|^2\right) dz \\ &amp; \quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad \text{ here, } \alpha \text{ is constant w.r.t. } z\\ &amp;= p(t+s,x,y) = \text{RHS} \end{aligned} \] (Note that we skipped one extra step to further simplify the second term. If needed, comment down below and I can provide it.)<br> <b>Step 2: (Total Probability)</b> For the total probability condition, we need to show that integrating over all possible values of y equals 1: \[ \begin{aligned} \int_{\mathbb{R}^n} p(t,x,y)dy &amp;= \int_{\mathbb{R}^n} (2\pi t)^{-n/2} \exp\left(-\frac{|x-y|^2}{2t}\right)dy \\ &amp;= 1 \end{aligned} \] This equality holds because we are integrating a properly normalized Gaussian density function. Therefore, the Brownian motion transition density satisfies both key conditions of Kolmogorov's Extension Theorem, confirming that it defines a valid stochastic process. </details> </div> <h3>Theorem 2.3: Kolmogorov's Continuity Theorem</h3> <p>Kolmogorov’s Continuity Theorem provides conditions under which a stochastic process has continuous paths. It is a fundamental result in the theory of stochastic processes and is particularly useful in the study of Brownian motion and diffusion processes.</p> <p><b>Theorem:</b> Let \(X = \{X_t : t \in T\}\) be a stochastic process. Suppose there exist constants $\alpha &gt; 0$, $\beta &gt; 0$, and $C &gt; 0$ such that for all $s, t \in T$,</p> \[\mathbb{E}[|X_t - X_s|^\alpha] \leq C |t - s|^{1 + \beta}\] <p>Then, there exists a modification of the process $X$ that has continuous paths with probability 1.</p> <p><b>Explanation:</b> The theorem essentially states that if the increments of a stochastic process satisfy a certain moment condition, then the process can be modified to have continuous paths. This is particularly important for ensuring that models like Brownian motion, which are used to describe continuous phenomena, are mathematically well-defined.</p> <p>This theorem is a cornerstone in the study of stochastic processes, providing the necessary conditions for the existence of continuous sample paths, which are crucial for modeling real-world phenomena where continuity is expected.</p> <div class="highlighted-box" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;"> <details> <summary>(Click to expand) Please refer to the derivation by <a href="https://fabricebaudoin.blog/2012/03/26/lecture-6-the-kolmogorov-continuity-theorem/" rel="external nofollow noopener" target="_blank">Prof. Fabrice Baudoin</a>. Intuitive explanation is attached here.</summary> <br> The Kolmogorov Continuity Theorem helps us understand when a stochastic process has continuous paths. Here's the intuitive idea:<br> 1. We start by looking at the process at discrete time points (like a grid).<br> 2. Using Chebyshev's inequality, we can show that large jumps between consecutive grid points are very unlikely:<br> \[ \text{max}_{1\leq k \leq 2^n} \left| X_{k/2^n} - X_{k-1/2^n} \right| \geq 2^{-\gamma n} \] 3. The Borel-Cantelli lemma then helps us prove that as we make our grid finer and finer (\(n\rightarrow \infty\)), the maximum size of these jumps becomes smaller and smaller:<br> \[ \left| X_t - X_s \right| \leq \frac{2C}{1-2^{-\gamma}}2^{-n\gamma} \] 4. This means that:<br> - The process becomes "smoother" as we look at it more closely<br> - Any discontinuities would have to be infinitely small<br> - Therefore, the process must be continuous "almost" surely<br> <br> This is particularly important for Brownian motion, as it guarantees that particle paths are continuous - there are no sudden teleportations or jumps in the motion. </details> </div> <h3>Connections between Diffusion and Brownian motion</h3> <p>Brownian motion is a specific stochastic process that models random, continuous motion, like the movement of particles in a fluid. Brownian motion is a basic building block used in many areas, such as modeling randomness, diffusion processes, and stochastic differential equations (SDEs). It has properties like,</p> <ul> <li>Gaussian increments: Changes over time follow a normal distribution.</li> <li>Continuous paths: The motion is smooth with no jumps.</li> <li>Independent increments: Motion over different time intervals is independent.</li> </ul> <p>Diffusion models are general frameworks used to model the evolution of a system over time, incorporating randomness. Diffusion models describe a forward process that adds noise to data (like images) step by step and a reverse process that removes the noise to recover the original data.</p> <p>Importantly,</p> <ul> <li>Brownian motion is a type of diffusion process where the motion is purely random, with no deterministic drift.</li> </ul> \[dX_t = \sigma dB_t ~~~~\text{(random motion)}\] <ul> <li>Diffusion models generalize the idea of Brownian motion by including a drift term and allowing for more complex dynamics.</li> </ul> \[dX_t = f(X-t, t)dt + g(X_t, t)dB_t ~~~~\text{(generalized)}\] <h3>Conclusion</h3> <p>In this blog post, we explored fundamental concepts in probability theory and stochastic processes that form the mathematical foundation of diffusion models. We covered key ideas like probability spaces, random variables, and stochastic processes, with a particular focus on Brownian motion. We also began to see how these mathematical tools connect to modern diffusion models used in machine learning.</p> <p>While this was an introductory look at these concepts, they are essential for understanding how diffusion models work at a deeper level. As we continue through the book in future posts, we will build on these fundamentals to develop a more comprehensive understanding of diffusion models and their theoretical underpinnings.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <script src="https://utteranc.es/client.js" repo="The-Stochastic-Journey/The-Stochastic-Journey.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@/dist/js/bootstrap.bundle.min.js" integrity="" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@/js/mdb.min.js" integrity="" crossorigin="anonymous"></script> <div class="container"> <div class="footer"> <br> </div> </div> </body> </html>